; Attempt to engrave scale rings
; Engraving is done in the XA plane and in the postive direction from X =0
; https://forum.linuxcnc.org/forum/20-g-code/27169-g-code-to-engrave-numbers-on-cylinders#40497
#<_dia> = 50 ; scale diamter it was 50
#<_depth> = 0.2 ; engraving depth it was 0.2
#<_height> = 2 ; character height
#<_scale> = 1 ; unit conversion
#<_inc> = 10 ; angle between marks
#<_alimentaz> = 20 ; si chiamava feed in origine ma nion funzionava

G21

F #<_alimentaz>

#41 = [180 / [#<_dia> * 3.14159] * #<_height>]
#42 = #<_height>
(debug, #41 #42)
 O0 sub
 G92 A0 X0
 G0 A0 X0 Z[#<_dia> / 2 + 1]
 G1 Z[#<_dia> / 2 - #<_depth>]
 A[0.2357 * #41] X[0.0976 * #42]
 A[0.3333 * #41] X[0.3333 * #42]
 A[0.3333 * #41] X[0.6667 * #42]
 A[0.2357 * #41] X[0.9024 * #42]
 A[0.0000 * #41] X[1.0000 * #42]
 A[-0.2357 * #41] X[0.9024 * #42]
 A[-0.3333 * #41] X[0.6667 * #42] 
 A[-0.3333 * #41] X[0.3333 * #42]
 A[0.0000* #41] X[0.0000 * #42]
 G0 Z[#<_dia> / 2 + 1]
 G92.1
 O0 endsub
 
 O1 sub
 G92 A0 X0
 G1 Z[#<_dia> / 2 - #<_depth>]
 A[0.0000 * #41] X[1.0000 * #42]
 G0 Z[#<_dia> / 2 + 1]
 G92.1
 O1 endsub
 
 O2 sub
 G92 A0 X0
 G0 A[0.3333 * #41] X[0.000 * #42] Z[#<_dia> / 2 + 1]
 G1 Z[#<_dia>/2 - #<_depth>]
 A[-.3333 * #41] X[0.0000 * #42]
 A[0.0000 * #41] X[0.3333 * #42]
 A[0.2357 * #41] X[0.4310 * #42]
 A[0.3333 * #41] X[0.6666 * #42]
 A[0.2357 * #41] X[0.9024 * #42]
 A[0.0000 * #41] X[1.0000 * #42]
 A[-.2357 * #41] X[0.9024 * #42] 
 A[-.3333 * #41] X[0.6667 * #42]
 G0 Z[#<_dia> / 2 + 1]
 G92.1
 O2 endsub
 
 O3 sub
 G92 A0 X0
 G0 A[-.3333 * #41] X[0.3333 * #42] Z[#<_dia> / 2 + 1]
 G1 Z[#<_dia>/2 - #<_depth>]
 A[-.2357 * #41] X[0.0976 * #42]
 A[0.0000 * #41] X[0.0000 * #42]
 A[0.2357 * #41] X[0.0976 * #42]
 A[0.3333 * #41] X[0.3333 * #42]
 A[0.2357 * #41] X[0.5690 * #42]
 A[0.0000 * #41] X[0.6667 * #42]
 A[0.3333 * #41] X[1.0000 * #42] 
 A[-.3333 * #41] X[1.0000 * #42]
 G0 Z[#<_dia> / 2 + 1]
 G92.1
 O3 endsub
 
 O4 sub
 G92 A0 X0
 G0 A[0.2357 * #41] X[0.000 * #42] Z[#<_dia> / 2 + 1]
 G1 Z[#<_dia>/2 - #<_depth>]
 A[0.2357 * #41] X[1.0000 * #42]
 A[-.3333 * #41] X[0.3333 * #42]
 A[0.3333 * #41] X[0.3333 * #42]
 G0 Z[#<_dia> / 2 + 1]
 G92.1
 O4 endsub
 
 O5 sub
 G92 A0 X0
 G0 A[-.3333 * #41] X[0.3333 * #42] Z[#<_dia> / 2 + 1]
 G1 Z[#<_dia>/2 - #<_depth>]
 A[-.2357 * #41] X[0.0976 * #42]
 A[0.0000 * #41] X[0.0000 * #42]
 A[0.2357 * #41] X[0.0976 * #42]
 A[0.3333 * #41] X[0.3333 * #42]
 A[0.2357 * #41] X[0.5690 * #42]
 A[0.0000 * #41] X[0.6667 * #42]
 A[-.3333 * #41] X[0.6667 * #42]
 A[-.3333 * #41] X[1.0000 * #42] 
 A[0.3333 * #41] X[1.0000 * #42]
 G0 Z[#<_dia> / 2 + 1]
 G92.1
 O5 endsub
 
 O6 sub
 G92 A0 X0
 G0 A[-.3333 * #41] X[0.0333 * #42] Z[#<_dia> / 2 + 1]
 G1 Z[#<_dia> / 2 - #<_depth>]
 A[-.2357 * #41] X[0.5690 * #42]
 A[0.0000 * #41] X[0.6667 * #42]
 A[0.2357 * #41] X[0.5690 * #42]
 A[0.3333 * #41] X[0.3333 * #42]
 A[0.2357 * #41] X[0.0976 * #42]
 A[0.0000 * #41] X[0.0000 * #42]
 A[-.2357 * #41] X[0.0967 * #42] 
 A[-.3333 * #41] X[0.3333 * #42]
 A[-.2357 * #41] X[0.9024 * #42]
 A[0.0000 * #41] X[1.0000 * #42]
 A[0.2357 * #41] X[0.9024 * #42]
 G0Z [#<_dia> / 2 + 1]
 G92.1
 O6 endsub
 
 O7 sub
 G92 A0 X0
 G0 A[-.2357 * #41] X[0.0000 * #42] Z[#<_dia> / 2 + 1]
 G1 Z[#<_dia>/2 - #<_depth>]
 A[0.3333 * #41] X[1.0000 * #42]
 A[-.3333 * #41] X[1.0000 * #42]
 G0 Z[#<_dia> / 2 + 1]
 G92.1
 O7 endsub
 
 O8 sub
 G92 A0 X0
 G0 A[0.2357 * #41] X[0.5690 * #42] Z[#<_dia> / 2 + 1]
 G1 Z[#<_dia> / 2 - #<_depth>]
 A[-.2357 * #41] X[0.5690 * #42]
 A[-.3333 * #41] X[0.3333 * #42]
 A[-.2357 * #41] X[0.0976 * #42]
 A[0.0000 * #41] X[0.0000 * #42]
 A[0.2357 * #41] X[0.0976 * #42]
 A[0.3333 * #41] X[0.3333 * #42]
 A[0.2357 * #41] X[0.5690 * #42] 
 A[0.3333 * #41] X[0.6667 * #42]
 A[0.2357 * #41] X[0.9024 * #42]
 A[0.0000 * #41] X[1.0000 * #42]
 A[-.2357 * #41] X[0.9024 * #42]
 A[-.3333 * #41] X[0.6667 * #42]
 A[-.2357 * #41] X[0.5690 * #42]
 G0 Z[#<_dia> / 2 + 1]
 G92.1
 O8 endsub
 
 O9 sub
 G92 A0 X0
 G0 A[-.3333 * #41] X[0.3333 * #42] Z[#<_dia> / 2 + 1]
 G1 Z[#<_dia>/2 - #<_depth>]
 A[-.2357 * #41] X[0.0976 * #42]
 A[0.0000 * #41] X[0.0000 * #42]
 A[0.2357 * #41] X[0.0976 * #42]
 A[0.3333 * #41] X[0.3333 * #42]
 A[0.3333 * #41] X[0.6667 * #42]
 A[0.2367 * #41] X[0.9024 * #42]
 A[0.0000 * #41] X[1.0000 * #42] 
 A[-.2357 * #41] X[0.9024 * #42]
 A[-.3333 * #41] X[0.6667 * #42]
 A[-.2357 * #41] X[0.4310 * #42]
 A[0.0000 * #41] X[0.3333 * #42]
 A[0.2357 * #41] X[0.4310 * #42]
 A[0.3333 * #41] X[0.6667 * #42]
 G0 Z[#<_dia> / 2 + 1]
 G92.1
 O9 endsub
 
 ; Start Engraving
 
 G92.1
 #3 = 0
 O100 while [#3 LT 360]
 #4 = [#3 * #<_scale>]
(DEBUG, #4)
 O101 if [#4 LT 10]
	G0 A#3 X0 Z[#<_dia> / 2 + 1]
	O[FIX[#4]] call
 O101 else if [#4 LT 100]
	G0 A[#3 - #42 * 0.5] X0 Z[#<_dia> / 2 + 1]
	O[FIX[#4 / 10]] call
	G0 A[#3 + #42 * 0.5] X0
	O[FIX[#4 mod 10]] call
 O101 else if [#4 LT 1000]
 	G0 A[#3 - #42 ] X0 Z[#<_dia> / 2 + 1]
	O[FIX[#4 / 100]] call
	G0 A#3 X0
	O[FIX[[#4/10] mod 10]] call
 	G0 A[#3 + #42 ] X0
	O[FIX[#4 mod 10]] call
 O101 endif
 
 #3 = [#3 + #<_inc>]
 O100 endwhile
 
 M2

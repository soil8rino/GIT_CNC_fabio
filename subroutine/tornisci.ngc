(info: asporta materiale laterale a una barra -- Ctrl-U modifica)

o<tornisci> sub
#<diam_fresa>       =  #1 (= 0.5 diam. fresa) 
#<vel_F>            =  #2 (= 1000 vel mandrino)

#<coord_x1>         =  #3 (= 10.00 1a x, fresa a sx del punto)
#<coord_x2>         =  #4 (= 14.00 2a x, fresa a sx del punto)

#<prof_asportaz>    =  #5 (= 0.2 spessore asprtz su X e Z)
#<diam_inizio>      =  #6 (= 12.5 diam barra)
#<diam_voluto>      =  #7 (= 8.5 diam voluto)


#<prof_taglio>           = [0.5 * [#6 - #7]]
#<z_finale>              = [0.5 * #6 - #<prof_taglio>]
#<lunghezza_asportaz>    = [ABS[#4 - #3]]
#<giri_da_fare>          = [FIX[#<z_finale> / #5]]
#<gradi_finali_affondo>  = [#<giri_da_fare> * 360]
#<gradi_finali_asportaz> = [[#<lunghezza_asportaz> / #<prof_asportaz>] * 360]

;subroutines di verifica inserimento dati corretti
o100 if [#<prof_asportaz> GT #<prof_taglio>]
(MSG, RICHIESTA IMPOSSIBILE !! Profondità di asportazione per singolo passaggio maggiore di quella di taglio finale)
M2 ; non fa nemmeno vedere il virtuale se la condizione è vera
o100 elseif [#<lunghezza_asportaz> LT #1] ; manca lo spazio per asportare
(MSG, Spazio tra le due coordinate X insufficiente per il diametro della fresa Necessari o fresa piu' piccola o spazio piu' grande)
M2 ; non fa nemmeno vedere il virtuale se la condizione è vera
o100 endif 

G91                                           ; coordinate relative
G0 Z[0.5 * #6]                                ; sale dal centro barra al bordo barra
G0 X[#3 + #1]                                 ; si sposta al punto x1 di tornitura
G1 Z#<z_finale> A#<gradi_finali_affondo> F#2  ; affonda gradualmente girando il mandrino fino alla prof richiesta
; G1 A[#<gradi_finali_affondo> + 360]      F#2  ; + 360 per fare un giro completo di rifinitura
G92 A0                                        ; azzera i gradi di rotazione

o150 if [#<lunghezza_asportaz> EQ 0]          ; se x1 e x2 sono uguali fermati dopo fatto il taglio
(MSG, eseguita asportazione)
M2
o150 elseif [#<lunghezza_asportaz> GT #1]     ; se non è solo affonda, prosegue asportazione verso X2

G1 X[#4+#1] A#<gradi_finali_asportaz> F#2     ; forse F#2 non necessaria
G1 A[#<gradi_finali_asportaz>+360]    F#2     ; forse F#2 non necessaria

o150 endif

o<tornisci> endsub
M2
